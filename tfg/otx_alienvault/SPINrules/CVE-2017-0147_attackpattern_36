CONSTRUCT{
        	?newap a cyberthreat_STIX:Attack_Pattern.
            ?newap cibersituational-ontology:name TCP Xmas Scan.
            ?newap cyberthreat_STIX:description An adversary uses a TCP XMAS scan to determine if ports are closed on the target machine. This scan type is accomplished by sending TCP segments with the all flags sent in the packet header, generating packets that are illegal based on RFC 793. The RFC 793 expected behavior is that any TCP segment with an out-of-state Flag sent to an open port is discarded, whereas segments with out-of-state flags sent to closed ports should be handled with a RST in response. This behavior should allow an attacker to scan for closed ports by sending certain types of rule-breaking packets (out of sync or disallowed by the TCB) and detect closed ports via RST packets. In addition to its relative speed when compared with other types of scans, its major advantage is its ability to scan through stateless firewall or ACL filters. Such filters are configured to block access to ports usually by preventing SYN packets, thus stopping any attempt to 'build' a connection. XMAS packets, like out-of-state FIN or ACK packets, tend to pass through such devices undetected. Many operating systems, however, do not implement RFC 793 exactly and for this reason FIN scans do not work as expected against these devices. Some operating systems, like Microsoft Windows, send a RST packet in response to any out-of-sync (or malformed) TCP segments received by a listening socket (rather than dropping the packet via RFC 793), thus preventing the adversary from distinguishing between open and closed ports. XMAS scans are limited by the range of platforms against which they work. Additionally, because open ports are inferred via no responses being generated, one cannot distinguish an open port from a filtered port without further analysis. For instance, XMAS scanning a system protected by a stateful firewall may indicate all ports being open. Because of their obvious rule-breaking nature, XMAS scans are flagged by almost all intrusion prevention or intrusion detection systems..
            ?newap cyberthreat_STIX:uses ?m.
            ?m cyberthreat_STIX:isUsedBy ?newap
        	?newap cyberthreat_STIX:targets ?v .
        }
        WHERE{
        	?v a cyberthreat_STIX:Vulnerability.
            ?m a cyberthreat_STIX:Malware.
        	?v cibersituational-ontology:name CVE-2017-0147.
            ?m cibersituational-ontology:name Matanbuchus.
        }